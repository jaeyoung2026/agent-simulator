# FINAL-SPEC.md까지의 여정: 실험 히스토리 스토리텔링

> **작성일**: 2026-01-31
> **목적**: working-contexts/ 폴더의 작업 히스토리를 분석하여 FINAL-SPEC.md 도달 과정 정리

---

## 프롤로그: 출발점

**Moonwriter**는 연구 발표 슬라이드를 논문 초안으로 변환하는 도구다. 핵심 질문은 간단했다:

> "슬라이드에서 의미 단위를 추출하고, 논문 구조로 변환하는 최적의 방법은 무엇인가?"

이 질문에 답하기 위해 **6번의 실험**이 진행되었고, 각 실험은 이전 실험의 발견을 기반으로 다음 질문을 제기했다.

---

## 1장: 기반 다지기 - 이해 문서 작성

### 배경

실험을 시작하기 전, 현재 시스템의 구조를 명확히 이해해야 했다.

### 작성된 문서

| 문서 | 목적 |
|------|------|
| `semantic-understanding.md` | 의미 추출의 베이스라인 정의 - Semantic Unit, Category, Role |
| `clustering-understanding.md` | 클러스터링의 베이스라인 정의 - Thesis-First, Direct/Distributed |
| `agent-utilization-guide.md` | 에이전트 자율 실험 프로토콜 정의 |

### 핵심 개념 정립

**삼분법 패턴**이 정립되었다:
```
원칙(Principles) → 전략(Strategy) → 출력(Output)
```

**5단계 Narrative Arc**:
```
배경/동기 → 방법론 → 결과 → 해석/논의 → 기여/향후
```

### 다음 질문

> "현재 LLM 기반 방식이 최선인가? 다른 방법론과 비교해보자."

---

## 2장: 방법론 탐색 - 1차 실험 (semantic-clustering)

### 실험 목적

4가지 의미 추출 + 클러스터링 방법론을 비교하여 최적의 조합 탐색

### 비교 대상

| 방법 | 의미 추출 | 클러스터링 | 특징 |
|------|----------|-----------|------|
| **Baseline** | LLM 직접 | LLM 직접 | 현재 방식 |
| **임베딩 기반** | 유사도 그룹화 | 키워드 매칭 | 저비용 |
| **Proposition** | 원자적 명제 분해 | 명제별 LLM | 최고 정밀도 |
| **하이브리드** | LLM 추출 | 키워드 초벌 + LLM 정제 | 균형 |

### 핵심 발견

```
하이브리드 방식 = 44% 비용 절감 + Baseline 품질 유지
```

- 임베딩 기반: "문제 해결"을 Results가 아닌 Discussion으로 오분류 (의미적 뉘앙스 실패)
- Proposition: 27개 명제로 과도한 분해 → 다시 묶어야 하는 역설
- **하이브리드**: 명확한 케이스는 키워드로, 경계 케이스만 LLM으로

### 결론

> "하이브리드 분류를 기본으로 채택하되, 품질 수준별 옵션을 제공하자."

### 다음 질문

> "사용자에게 몇 가지 옵션을 제공할 것인가? 각 옵션의 비용-품질 트레이드오프는?"

---

## 3장: 3가지 옵션 설계 - 2차 실험 (final)

### 실험 목적

Quick Draft / Standard / Premium 3가지 옵션을 설계하고 검증

### 옵션 정의

| 옵션 | 의미 추출 | 클러스터링 | 비용 |
|------|----------|-----------|------|
| **Quick Draft** | Direct LLM | 키워드 100% | 1x ($0.012) |
| **Standard** | CoT 3단계 | 하이브리드 | 4x ($0.047) |
| **Premium** | Self-Critique 4단계 | Thesis-First 4단계 | 13x ($0.160) |

### 핵심 발견

```
Standard = 비용 대비 최적 균형 (권장 기본 옵션)
Premium = 역개요 검증 87-89% 정렬 달성
```

**Writing Principles 효과**:
- Thesis + 이정표 + 글루 문장이 논문 품질에 가장 큰 영향
- Premium의 "Other" 분류 0% - 모든 유닛이 명확한 단계에 배치

### 미해결 문제

- 모든 옵션에서 이미지 분석 필요 (v1에서 Quick Draft는 이미지 분석 없음)
- Pro 모델을 어느 옵션까지 사용할 것인가?

### 다음 질문

> "모든 옵션에서 Pro 검증을 사용해야 하는가? 최적의 모델 배분은?"

---

## 4장: 모델 배분 최적화 - 3-4차 실험 (exp3-4)

### 실험 목적

- **exp3**: Gemini Flash/Pro 모델 배분 비교
- **exp4**: Claude Haiku/Sonnet/Opus 모델 배분 + 해상도 비교

### 핵심 발견

**모든 옵션에서 Pro(Opus) 검증 사용이 효과적**:

| 옵션 | Pro 효과 |
|------|---------|
| Quick Draft | 63.5% 보완 |
| Standard | 38.2% 분류 정제 |
| Premium | 81.7% 최고 품질 |

**해상도 권장**:

```
Low (1-2)   : 22% 정보 손실, 66% 이미지 누락 → 빠른 스크리닝용
Medium (1-3): 균형 잡힌 분포 → 일반 권장
High (1-5)  : 42% 소형 유닛 (과세분화) → 상세 분석용
```

### 결론

> "Standard + Medium + Sonnet+Opus 조합이 기본 권장"

### 다음 질문

> "Pro 모델을 어느 단계에서만 사용해도 되는가? 비용을 더 줄일 수 있는가?"

---

## 5장: 전략 대결 - 5차 실험 (exp5)

### 실험 목적

**Direct 전략** vs **Distributed 전략** 비교 및 비용 최적화

### 전략 정의

```
Direct:      의미 단위 → Flash 전체 분석 → Pro 검증
Distributed: 1단계(Flash) → 2단계(Flash 병렬) → 3단계(Flash) → 4단계(Pro)
```

### 핵심 발견

**Flash 1-3 + Pro 4 최적화**:

```
┌─────────────────────────────────────────────────┐
│  단계 1-3: Flash (Sonnet)  │  단계 4: Pro (Opus) │
│  - Thesis 추출              │  - 최종 품질 검증   │
│  - 클러스터 분석             │  - Gap 분석        │
│  - 일관성 검증               │  - Writing 평가    │
│  토큰 비율: 85-90%          │  토큰 비율: 10-15% │
│  비용 비율: 15%             │  비용 비율: 85%    │
└─────────────────────────────────────────────────┘
결과: 84-87% 비용 절감 + 품질 유지
```

### 충격적 발견

> **Premium이 Standard보다 더 저렴하면서 품질이 높다!**

| 지표 | Standard | Premium (최적화) |
|------|----------|-----------------|
| 품질 | 0.63 | 0.77 (+22%) |
| 일관성 | 0.55 | 0.89 (+62%) |
| Thesis 정렬 | 49% | 96% (+96%) |
| 비용 | $0.055 | $0.0008 (**-98%**) |

### 문제 발견

Standard와 Premium이 같은 모델 배분을 사용하므로 비용 차이가 27%에 불과 → **가격 차별화 정당성 부족**

### 다음 질문

> "비용이 아닌 다른 방식으로 Premium 가치를 차별화할 수 있는가?"

---

## 6장: 기능 차별화 - 6차 실험 (exp6)

### 실험 목적

동일 모델 배분에서 **기능 차별화**로 Premium 가치 검증

### 테스트 조건

| 구분 | Standard | Premium |
|------|----------|---------|
| 모델 배분 | Flash 1-3 + Pro 4 | Flash 1-3 + Pro 4 (동일) |
| Self-Critique | ✗ | ✓ |
| 역개요 검증 | ✗ | ✓ |
| Writing Principles | 3개 | 6개 |
| 플레이스홀더 | 위치만 | 구체적 제안 |
| 이미지 분석 | 유형+역할 | 심층+재현성 |

### 6가지 조합 테스트 결과

| 옵션 | 해상도 | Quality | Consistency | Alignment | Cost |
|------|--------|---------|-------------|-----------|------|
| Standard | Low | 0.83 | 1.00 | - | $0.0005 |
| Standard | Medium | 0.76 | 0.91 | - | $0.0006 |
| Standard | High | 0.79 | 0.89 | - | $0.0006 |
| Premium | Low | 0.69 | 0.80 | 81% | $0.0008 |
| Premium | Medium | 0.75 | 0.92 | **100%** | $0.0009 |
| Premium | High | 0.71 | 0.86 | 92% | $0.0010 |

### 핵심 발견

**Medium 해상도에서 Premium 효과 극대화**:
- **100% Thesis 정렬** 달성
- 비용 차이 50-67%로 합리적

**Premium 전용 가치**:
- Writing Principles 6개 (평균 0.85)
- Self-Critique (평균 0.80)
- 역개요 검증
- 구체적 플레이스홀더 (실험 제안 포함)
- 심층 이미지 분석 (재현성 정보)

### 결론

> "모델 배분은 동일하게 유지하고, 기능 차별화로 Premium 가치를 창출한다."

---

## 에필로그: FINAL-SPEC.md 탄생

### 최종 결정사항

모든 실험 결과를 종합하여 다음이 확정되었다:

**1. 3가지 옵션 (해상도 고정)**

| 옵션 | 전략 | 해상도 | 용도 |
|------|------|--------|------|
| **Quick Draft** | Direct | Low (1-2) | 빠른 스크리닝 |
| **Standard** | Distributed | Medium (1-3) | 일반 논문 작성 |
| **Premium** | Distributed | Medium (1-3) | 고품질 제출물 |

**2. 모델 배분 (공통)**

```
Step 1-3: Flash (Sonnet) - 추출, 분류, 검증
Step 4:   Pro (Opus)     - 최종 품질 검증
```

**3. 기능 차별화**

```
┌─────────────────────────────────────────────────────────────────────┐
│                    Quick Draft    Standard       Premium            │
├─────────────────────────────────────────────────────────────────────┤
│ 해상도             Low (1-2)      Medium (1-3)   Medium (1-3)       │
│ 전략               Direct         Distributed    Distributed        │
│ Writing Principles 최소           3개            6개                │
│ 역개요 검증        ✗              ✗              ✓                  │
│ Self-Critique      ✗              ✗              ✓                  │
│ 이미지 분석        유형만         유형+역할      심층+재현성        │
│ 비용 비율          0.5x           1x (기준)      1.5-1.7x           │
└─────────────────────────────────────────────────────────────────────┘
```

**4. 가격 정책**

| 옵션 | 가격 비율 | 근거 |
|------|----------|------|
| Quick Draft | 0.5x | 빠른 처리, Low 해상도 |
| Standard | 1x (기준) | 균형 잡힌 품질 |
| Premium | 1.5-1.7x | 추가 기능 가치 |

---

## 여정의 교훈

### 1. 실험은 선형이 아니다

```
1차 → 2차 → 3차 → 4차 → 5차 → 6차
        ↑                    ↓
        └──── 역설 발견 ─────┘
```

5차 실험에서 "Premium이 Standard보다 저렴하면서 품질 높음"이라는 역설을 발견하고, 6차 실험에서 기능 차별화로 해결했다.

### 2. 비용 최적화의 핵심

```
Pro 모델이 40-50배 비쌈 → Pro는 최종 검증에만 사용
Flash로 85-90% 처리 → 84-87% 비용 절감
```

### 3. 차별화는 비용이 아닌 기능으로

```
같은 모델 배분 + 같은 비용 구조 = 가격 차별화 실패
같은 모델 배분 + 추가 기능 = 가치 차별화 성공
```

---

## 산출물 맵

```
working-contexts/
├── 이해 문서 (실험 전)
│   ├── semantic-understanding.md
│   ├── clustering-understanding.md
│   └── agent-utilization-guide.md
│
├── experiments/
│   ├── 2026-01-31-semantic-clustering/  ← 1차: 방법론 비교
│   │   └── comparison-report.md
│   │
│   ├── 2026-01-31-final/                ← 2차: 3옵션 설계
│   │   └── final-report-v2.md
│   │
│   └── 2026-01-31-exp2/                 ← 3-6차: 최적화
│       ├── exp3-final-report.md         ← 3차: 모델 배분
│       ├── exp4-final-report.md         ← 4차: 해상도
│       ├── exp5-final-report.md         ← 5차: Direct vs Distributed
│       ├── exp6-comparison-report.md    ← 6차: 기능 차별화
│       └── DISCUSSION-PENDING.md        ← 결정 완료
│
└── FINAL-SPEC.md  ← 최종 스펙 (루트)
```

---

> **요약**: 6번의 실험을 통해 "의미 추출 방법론"부터 "가격 차별화 전략"까지 모든 의사결정이 데이터 기반으로 이루어졌다. 핵심은 **Flash 1-3 + Pro 4 최적화**(84-87% 비용 절감)와 **기능 차별화**(역개요 검증, Writing Principles 6개, Self-Critique)로 Premium 가치를 창출한 것이다.
